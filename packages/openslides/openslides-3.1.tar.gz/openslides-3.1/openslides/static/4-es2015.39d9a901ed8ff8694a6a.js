(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{Iab2:function(t,e,n){var i,o;void 0===(o="function"==typeof(i=function(){"use strict";function e(t,e,n){var i=new XMLHttpRequest;i.open("GET",t),i.responseType="blob",i.onload=function(){r(i.response,e,n)},i.onerror=function(){console.error("could not download file")},i.send()}function n(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function i(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(e){var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(n)}}var o="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,r=o.saveAs||("object"!=typeof window||window!==o?function(){}:"download"in HTMLAnchorElement.prototype?function(t,r,a){var s=o.URL||o.webkitURL,l=document.createElement("a");l.download=r=r||t.name||"download",l.rel="noopener","string"==typeof t?(l.href=t,l.origin===location.origin?i(l):n(l.href)?e(t,r,a):i(l,l.target="_blank")):(l.href=s.createObjectURL(t),setTimeout((function(){s.revokeObjectURL(l.href)}),4e4),setTimeout((function(){i(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,o,r){if(o=o||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,r),o);else if(n(t))e(t,o,r);else{var a=document.createElement("a");a.href=t,a.target="_blank",setTimeout((function(){i(a)}))}}:function(t,n,i,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof t)return e(t,n,i);var a="application/octet-stream"===t.type,s=/constructor/i.test(o.HTMLElement)||o.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||a&&s)&&"object"==typeof FileReader){var c=new FileReader;c.onloadend=function(){var t=c.result;t=l?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=t:location=t,r=null},c.readAsDataURL(t)}else{var d=o.URL||o.webkitURL,f=d.createObjectURL(t);r?r.location=f:location.href=f,r=null,setTimeout((function(){d.revokeObjectURL(f)}),4e4)}});o.saveAs=r.saveAs=r,t.exports=r})?i.apply(e,[]):i)||(t.exports=o)},a9GI:function(t,e,n){"use strict";(function(t){n.d(e,"d",(function(){return p})),n.d(e,"a",(function(){return u})),n.d(e,"c",(function(){return h})),n.d(e,"b",(function(){return m}));var i=n("mrSG"),o=n("IheW"),r=n("Iab2"),a=n("Y3lY"),s=n("+KbT"),l=n("Hila"),c=n("x4ls"),d=n("8Y7J"),f=n("TSSN"),g=n("dFDH"),p=function(t){return t.DEFAULT="tocEntry",t.SUBTITLE="subtitle",t.SUB_ENTRY="tocSubEntry",t.CATEGORY_SECTION="tocCategorySection",t}({}),u=function(t){return t.DEFAULT="noBorders",t.LIGHT_HORIZONTAL_LINES="lightHorizontalLines",t.HEADER_ONLY="headerLineOnly",t}({});class h extends Error{constructor(t){super(t),this.message=t;const e=new.target.prototype;this.__proto__=e}}let m=(()=>{class e{constructor(t,e,n,i,o){this.translate=t,this.configService=e,this.httpService=n,this.matSnackBar=i,this.progressService=o,this.imageUrls=[]}initVfs(){return i.a(this,void 0,void 0,(function*(){const t=Array.from(new Set(this.configService.instant("fonts_available").map(t=>this.configService.instant(t)).map(t=>t.path||`/${t.default}`))).map(t=>this.convertUrlToBase64(t).then(e=>({[t.split("/").pop()]:e}))),e=yield Promise.all(t);let n={};return e.map(t=>{n=Object.assign({},n,t)}),n}))}convertUrlToBase64(t){return i.a(this,void 0,void 0,(function*(){return new Promise((e,n)=>{const i=new o.h;this.httpService.get(t,{},{},i,"blob").then(t=>{const i=new FileReader;i.readAsDataURL(t),i.onload=()=>{e(i.result.split(",")[1])},i.onerror=t=>{n(t)}})})}))}getFontName(t){const e=this.configService.instant(t);return(e.path||`/${e.default}`).split("/").pop()}getStandardPaper(t,e,n,o,r,a){return i.a(this,void 0,void 0,(function*(){this.imageUrls=o||[];const i=this.configService.instant("general_export_pdf_pagesize");return{pageSize:i||"A4",pageOrientation:a?"landscape":"portrait",pageMargins:r||("A5"===i?[45,30,45,45]:[75,90,75,75]),defaultStyle:{font:"PdfFont",fontSize:this.configService.instant("general_export_pdf_fontsize")},header:this.getHeader(r?[r[0],r[2]]:null),tmpfooter:this.getFooter(r?[r[0],r[2]]:null,n),info:e,content:t,styles:this.getStandardPaperStyles()}}))}getBallotPaper(t,e){return i.a(this,void 0,void 0,(function*(){return this.imageUrls=e?[e]:[],{pageSize:"A4",pageMargins:[0,0,0,0],defaultStyle:{font:"PdfFont",fontSize:10},content:t,styles:this.getBlankPaperStyles()}}))}getPdfFonts(){return{normal:this.getFontName("font_regular"),bold:this.getFontName("font_bold"),italics:this.getFontName("font_italic"),bolditalics:this.getFontName("font_bold_italic")}}getHeader(t){let e,n=this.configService.instant("logo_pdf_header_L").path,i=this.configService.instant("logo_pdf_header_R").path;const o=[];if(n&&(0===n.indexOf("/")&&(n=n.substr(1)),o.push({image:n,fit:[180,40],width:"20%"}),this.imageUrls.push(n)),n&&i)e="";else{const t=this.configService.instant("general_event_name"),n=this.configService.instant("general_event_description");e=[[this.translate.instant(t),this.translate.instant(n)].filter(Boolean).join(" \u2013 "),[this.configService.instant("general_event_location"),this.configService.instant("general_event_date")].filter(Boolean).join(", ")].join("\n")}return o.push({text:e,style:"headerText",alignment:i?"left":"right"}),i&&(0===i.indexOf("/")&&(i=i.substr(1)),o.push({image:i,fit:[180,40],alignment:"right",width:"20%"}),this.imageUrls.push(i)),{color:"#555",fontSize:9,margin:[t?t[0]:75,30,t?t[0]:75,10],columns:o,columnGap:10}}getFooter(t,e){const n=[],i=!e||!e.pdfOptions||e.pdfOptions.includes("page"),o=!(!e||!e.pdfOptions)&&e.pdfOptions.includes("date");let r,a,s;const l=this.configService.instant("logo_pdf_footer_L").path,c=this.configService.instant("logo_pdf_footer_R").path;let d="";i&&(d+="%PAGENR%");let f={};return o&&(f={text:`${this.translate.instant("As of")}: ${(new Date).toLocaleDateString(this.translate.currentLang)}`,fontSize:6}),l&&c?(r="20%",s=[180,40]):(r="80%",s=[400,50]),a=l&&c?"center":l&&!c?"right":c&&!l?"left":this.configService.instant("general_export_pdf_pagenumber_alignment"),l&&(n.push({image:l,fit:s,width:r,alignment:"left"}),this.imageUrls.push(l)),n.push({stack:[d,f],style:"footerPageNumber",alignment:a}),c&&(n.push({image:c,fit:s,width:r,alignment:"right"}),this.imageUrls.push(c)),{margin:[t?t[0]:75,0,t?t[0]:75,10],columns:n,columnGap:10}}showProgress(){this.matSnackBar.openFromComponent(a.a,{duration:0}).onAction().subscribe(()=>{this.cancelPdfCreation()}),this.progressService.message=this.translate.instant("Creating PDF file ..."),this.progressService.progressMode="determinate"}download(t,e,n,i){this.showProgress(),this.getStandardPaper(t,n,i).then(t=>{this.createPdf(t,e)})}downloadLandscape(t,e,n){this.showProgress(),this.getStandardPaper(t,n,null,null,[50,80,50,75],!0).then(t=>{this.createPdf(t,e)})}downloadWithBallotPaper(t,e,n){this.showProgress(),this.getBallotPaper(t,n).then(t=>{this.createPdf(t,e)})}createPdf(e,n){return i.a(this,void 0,void 0,(function*(){const i=`${n}.pdf`,o=this.getPdfFonts(),a=yield this.initVfs();yield this.loadAllImages(a);const s=/msie\s|trident\//i.test(window.navigator.userAgent);"undefined"==typeof Worker||s?(this.matSnackBar.dismiss(),this.matSnackBar.open(this.translate.instant("Cannot create PDF files on this browser."),"",{duration:0})):(this.pdfWorker=new Worker(t,{}),this.pdfWorker.onmessage=({data:t})=>{if("number"==typeof t){const e=Math.ceil(100*t);this.progressService.progressAmount=e}"object"==typeof t&&(this.matSnackBar.dismiss(),Object(r.saveAs)(t,i,{autoBOM:!0}),this.pdfWorker=null)},this.pdfWorker.postMessage({doc:JSON.parse(JSON.stringify(e)),fonts:o,vfs:a}))}))}cancelPdfCreation(){this.pdfWorker&&(this.pdfWorker.terminate(),this.pdfWorker=null)}getStandardPaperStyles(){const t=this.configService.instant("general_export_pdf_pagesize");return{title:{fontSize:"A5"===t?14:16,margin:[0,0,0,20],bold:!0},subtitle:{fontSize:9,margin:[0,-20,0,20],color:"grey"},preamble:{margin:[0,0,0,10]},headerText:{fontSize:10,margin:[0,10,0,0]},footerPageNumber:{fontSize:8,margin:[0,15,0,0],color:"#555"},boldText:{bold:!0},smallText:{fontSize:8},heading2:{fontSize:"A5"===t?12:14,margin:[0,0,0,10],bold:!0},heading3:{fontSize:"A5"===t?10:12,margin:[0,10,0,0],bold:!0},userDataHeading:{fontSize:14,margin:[0,10],bold:!0},userDataTopic:{fontSize:12,margin:[0,5]},userDataValue:{fontSize:12,margin:[15,5]},tocEntry:{fontSize:"A5"===t?10:11,margin:[0,0,0,0],bold:!1},tocHeaderRow:{fontSize:7},tocSubEntry:{fontSize:"A5"===t?9:10,color:"#404040"},tocCategoryEntry:{fontSize:"A5"===t?10:11,margin:[10,0,0,0],bold:!1},tocCategoryTitle:{fontSize:"A5"===t?10:11,margin:[0,0,0,4],bold:!0},tocSubcategoryTitle:{fontSize:"A5"===t?9:10,margin:[0,0,0,4],bold:!0},tocCategorySection:{margin:[0,0,0,10]},userDataTitle:{fontSize:26,margin:[0,0,0,0],bold:!0},tableHeader:{bold:!0,fillColor:"white"},listParent:{fontSize:14,margin:[0,5]},listChild:{fontSize:12,margin:[0,5]},textItem:{fontSize:11,margin:[0,7]}}}getBlankPaperStyles(){return{title:{fontSize:14,bold:!0,margin:[30,30,0,0]},description:{fontSize:11,margin:[30,0,0,0]}}}loadAllImages(t){return i.a(this,void 0,void 0,(function*(){const e=this.imageUrls.map(e=>this.addImageToVfS(e,t));yield Promise.all(e)}))}addImageToVfS(t,e){return i.a(this,void 0,void 0,(function*(){if(0===t.indexOf("/")&&(t=t.substr(1)),!e[t]){const n=yield this.convertUrlToBase64(t);e[t]=n}}))}createTitle(t){return{text:this.translate.instant(this.configService.instant(t)),style:"title"}}createPreamble(t){const e=this.configService.instant(t);return e?{text:e,style:"preamble"}:{}}getPageBreak(){return{text:"",pageBreak:"after"}}createTocTableDef(t,e=p.DEFAULT,n=u.DEFAULT,...i){return{table:{headerRows:i[0]?i.length:0,keepWithHeaderRows:i[0]?i.length:0,dontBreakRows:!0,widths:["auto","*","auto"],body:i[0]?[...i,...t]:t},layout:n,style:e}}createTocLine(t,e,n,i=p.DEFAULT,...o){return[{text:t,style:i},{text:[e,...o],style:"tocEntry"},{pageReference:n,style:"tocEntry",alignment:"right"}]}createTocLineInline(t,e=!1){return{text:"\n"+t,style:p.SUB_ENTRY,italics:e}}drawCircle(t,e){return[{type:"ellipse",x:0,y:t,lineColor:"black",r1:e,r2:e}]}}return e.ngInjectableDef=d.Tb({factory:function(){return new e(d.Ub(f.k),d.Ub(s.a),d.Ub(l.a),d.Ub(g.b),d.Ub(c.a))},token:e,providedIn:"root"}),e})()}).call(this,n("ppA2"))},ppA2:function(t,e,n){t.exports=n.p+"0-es2015.7374762378c91a96de9e.worker.js"}}]);