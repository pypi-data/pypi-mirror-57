(window.webpackJsonpclient=window.webpackJsonpclient||[]).push([[0],{110:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(13),c=a.n(o),l=(a(86),a(11)),s=a(8),i=a(20),p=a(21),m=a(22),u=a(145),d=a(39),h=a(35),g=a(28),f=a(16),b=a(25),E=a.n(b),y=a(37),v=a(142),j=a(26),O=a.n(j),N=a(27),x=a.n(N),k=a(137),w=a(141),S=a(140),C=a(138),W=a(139),B=a(116),L=a(66),M=a.n(L),P=a(67),D=a.n(P),I=a(45),_=a.n(I),A=function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.text,r=this.props.percent;r=Math.max(r,0);var o=[0,255,0],c=o,l=function(e,t,a){var r=Object(g.a)(e,3),n=r[0],o=r[1],c=r[2],l=Object(g.a)(t,3);return[n*(1-a)+l[0]*a,o*(1-a)+l[1]*a,c*(1-a)+l[2]*a]}(o,[255,0,0],(r=Math.min(r,100))/100),s="\n      linear-gradient(\n        to right,\n        rgba(".concat(c.join(","),", ").concat(.2,") 0%,\n        rgba(").concat(l.join(","),", ").concat(.2,") ").concat(r,"%,\n        transparent ").concat(r,"%\n      )\n    ");return n.a.createElement("div",{className:t.root},n.a.createElement("div",{style:{background:s}},a))}}]),t}(n.a.Component),F=x()(function(e){return O()({root:{borderColor:e.palette.divider,borderStyle:"solid",borderWidth:1}})})(A);function R(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function U(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?R(a,!0).forEach(function(t){Object(f.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):R(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var z=function(e,t){return"".concat((e/("mebibyte"===t?Math.pow(1024,2):Math.pow(1024,3))).toFixed(1)," ").concat("mebibyte"===t?"MiB":"GiB")},H=function(e,t,a){var r=z(e,a),n=z(t,a),o=100*e/t;return"".concat(r," / ").concat(n," (").concat(o.toFixed(0),"%)")},T=function(e){var t=Date.now()/1e3-e,a=Math.floor(t)%60,r=Math.floor(t/60)%60,n=Math.floor(t/60/60)%24,o=Math.floor(t/60/60/24),c=function(e){return e.toString().padStart(2,"0")};return[o?"".concat(o,"d"):"","".concat(c(n),"h"),"".concat(c(r),"m"),"".concat(c(a),"s")].join(" ")},V=function(e){function t(){var e,a;Object(l.a)(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).state={response:null,error:null,expanded:{}},a.fetchNodeInfo=Object(y.a)(E.a.mark(function e(){var t,r,n;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=new URL("/api/node_info",window.location.origin),e.next=4,fetch(t.toString());case 4:return r=e.sent,e.next=7,r.json();case 7:n=e.sent,a.setState({response:n,error:null}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),a.setState({response:null,error:e.t0.toString()});case 14:return e.prev=14,setTimeout(a.fetchNodeInfo,1e3),e.finish(14);case 17:case"end":return e.stop()}},e,null,[[0,11,14,17]])})),a.toggleExpand=function(e){return function(){a.setState(function(t){return{expanded:U({},t.expanded,Object(f.a)({},e,!t.expanded[e]))}})}},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=Object(y.a)(E.a.mark(function e(){return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchNodeInfo();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.classes,a=this.state,r=a.response,o=a.error,c=a.expanded;if(null!==o)return n.a.createElement(B.a,{className:t.root,color:"error"},o);if(null===r)return n.a.createElement(B.a,{className:t.root,color:"textSecondary"},"Loading...");var l=r.result,s=r.timestamp,i={},p={},m=!0,u=!1,h=void 0;try{for(var f,b=l.clients[Symbol.iterator]();!(m=(f=b.next()).done);m=!0){var E=f.value;i[E.ip]={perWorker:{},total:0},p[E.ip]={perWorker:{},total:0};var y=!0,j=!1,O=void 0;try{for(var N,x=E.workers[Symbol.iterator]();!(y=(N=x.next()).done);y=!0){var L=N.value;i[E.ip].perWorker[L.pid]=0,p[E.ip].perWorker[L.pid]=0}}catch(re){j=!0,O=re}finally{try{y||null==x.return||x.return()}finally{if(j)throw O}}}}catch(re){u=!0,h=re}finally{try{m||null==b.return||b.return()}finally{if(u)throw h}}for(var P=0,I=Object.keys(l.log_counts);P<I.length;P++){var A=I[P];if(A in i)for(var R=0,U=Object.entries(l.log_counts[A]);R<U.length;R++){var V=U[R],J=Object(g.a)(V,2),G=J[0],X=J[1];i[A].perWorker[G]=X,i[A].total+=X}}for(var q=0,K=Object.keys(l.error_counts);q<K.length;q++){var Q=K[q];if(Q in p)for(var Y=0,Z=Object.entries(l.error_counts[Q]);Y<Z.length;Y++){var $=Z[Y],ee=Object(g.a)($,2),te=ee[0],ae=ee[1];p[Q].perWorker[te]=ae,p[Q].total+=ae}}return n.a.createElement("div",{className:t.root},n.a.createElement(B.a,{variant:"h5"},"Ray Dashboard"),n.a.createElement(k.a,null,n.a.createElement(C.a,null,n.a.createElement(W.a,null,n.a.createElement(S.a,{className:t.cell}),n.a.createElement(S.a,{className:t.cell},"Host"),n.a.createElement(S.a,{className:t.cell},"Workers"),n.a.createElement(S.a,{className:t.cell},"Uptime"),n.a.createElement(S.a,{className:t.cell},"CPU"),n.a.createElement(S.a,{className:t.cell},"RAM"),n.a.createElement(S.a,{className:t.cell},"Disk"),n.a.createElement(S.a,{className:t.cell},"Logs"),n.a.createElement(S.a,{className:t.cell},"Errors"))),n.a.createElement(w.a,null,l.clients.map(function(a){return n.a.createElement(n.a.Fragment,{key:a.ip},n.a.createElement(W.a,{hover:!0},n.a.createElement(S.a,{className:_()(t.cell,t.expandCollapseCell),onClick:e.toggleExpand(a.ip)},c[a.ip]?n.a.createElement(D.a,{className:t.expandCollapseIcon}):n.a.createElement(M.a,{className:t.expandCollapseIcon})),n.a.createElement(S.a,{className:t.cell},a.hostname," (",a.ip,")"),n.a.createElement(S.a,{className:t.cell},a.workers.length),n.a.createElement(S.a,{className:t.cell},T(a.boot_time)),n.a.createElement(S.a,{className:t.cell},n.a.createElement("div",{className:t.cpuUsage},n.a.createElement(F,{percent:a.cpu,text:"".concat(a.cpu.toFixed(1),"%")}))),n.a.createElement(S.a,{className:t.cell},n.a.createElement(F,{percent:100*(a.mem[0]-a.mem[1])/a.mem[0],text:H(a.mem[0]-a.mem[1],a.mem[0],"gibibyte")})),n.a.createElement(S.a,{className:t.cell},n.a.createElement(F,{percent:100*a.disk["/"].used/a.disk["/"].total,text:H(a.disk["/"].used,a.disk["/"].total,"gibibyte")})),n.a.createElement(S.a,{className:t.cell},0===i[a.ip].total?n.a.createElement("span",{className:t.secondary},"No logs"):n.a.createElement(v.a,{component:d.b,to:"/logs/".concat(a.hostname)},"View all logs (",i[a.ip].total.toLocaleString()," ",1===i[a.ip].total?"line":"lines",")")),n.a.createElement(S.a,{className:t.cell},0===p[a.ip].total?n.a.createElement("span",{className:t.secondary},"No errors"):n.a.createElement(v.a,{component:d.b,to:"/errors/".concat(a.hostname)},"View all errors (",p[a.ip].total.toLocaleString(),")"))),c[a.ip]&&a.workers.map(function(e,r){return n.a.createElement(W.a,{hover:!0,key:r},n.a.createElement(S.a,{className:t.cell}),n.a.createElement(S.a,{className:t.cell},e.cmdline[0].split(":",2)[0]," (PID:"," ",e.pid,")"),n.a.createElement(S.a,{className:t.cell},e.cmdline[0].split(":",2)[1]||n.a.createElement("span",{className:t.secondary},"Idle")),n.a.createElement(S.a,{className:t.cell},T(e.create_time)),n.a.createElement(S.a,{className:t.cell},n.a.createElement(F,{percent:e.cpu_percent,text:"".concat(e.cpu_percent.toFixed(1),"%")})),n.a.createElement(S.a,{className:t.cell},n.a.createElement(F,{percent:100*e.memory_info.rss/a.mem[0],text:z(e.memory_info.rss,"mebibyte")})),n.a.createElement(S.a,{className:t.cell},n.a.createElement("span",{className:t.secondary},"Not available")),n.a.createElement(S.a,{className:t.cell},0===i[a.ip].perWorker[e.pid]?n.a.createElement("span",{className:t.secondary},"No logs"):n.a.createElement(v.a,{component:d.b,to:"/logs/".concat(a.hostname,"/").concat(e.pid)},"View log (",i[a.ip].perWorker[e.pid].toLocaleString()," ",1===i[a.ip].perWorker[e.pid]?"line":"lines",")")),n.a.createElement(S.a,{className:t.cell},0===p[a.ip].perWorker[e.pid]?n.a.createElement("span",{className:t.secondary},"No errors"):n.a.createElement(v.a,{component:d.b,to:"/errors/".concat(a.hostname,"/").concat(e.pid)},"View errors (",p[a.ip].perWorker[e.pid].toLocaleString(),")")))}))}))),n.a.createElement(B.a,{align:"center"},"Last updated: ",new Date(1e3*s).toLocaleString()))}}]),t}(n.a.Component),J=x()(function(e){return O()({root:{backgroundColor:e.palette.background.paper,padding:e.spacing(2),"& > :not(:first-child)":{marginTop:e.spacing(2)}},cell:{padding:e.spacing(1),textAlign:"center","&:last-child":{paddingRight:e.spacing(1)}},expandCollapseCell:{cursor:"pointer"},expandCollapseIcon:{color:e.palette.text.secondary,fontSize:"1.5em",verticalAlign:"middle"},cpuUsage:{minWidth:60},secondary:{color:e.palette.text.secondary}})})(V),G=a(143),X=a(144),q=a(56),K=a(52),Q=a.n(K),Y=function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.lines;return n.a.createElement(k.a,null,n.a.createElement(w.a,null,a.map(function(e,a){return n.a.createElement(W.a,{key:a},n.a.createElement(S.a,{className:_()(t.cell,t.lineNumber),"data-line-number":a+1}),n.a.createElement(S.a,{className:_()(t.cell,t.line)},e))})))}}]),t}(n.a.Component),Z=x()(function(e){return O()({root:{overflowX:"auto"},cell:{borderWidth:0,fontFamily:"SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace",padding:0,"&:last-child":{paddingRight:0}},lineNumber:{color:e.palette.text.secondary,paddingRight:e.spacing(2),textAlign:"right",verticalAlign:"top",width:"1%","&::before":{content:"attr(data-line-number)"}},line:{textAlign:"left",whiteSpace:"pre-wrap"}})})(Y),$=function(e){function t(){var e,a;Object(l.a)(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).state={result:null,error:null},a.handleClose=function(){a.props.history.push("/")},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=Object(y.a)(E.a.mark(function e(){var t,a,r,n,o,c,l;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.props.match,a=t.params,r=a.hostname,n=a.pid,(o=new URL("/api/errors",window.location.origin)).searchParams.set("hostname",r),o.searchParams.set("pid",n||""),e.next=8,fetch(o.toString());case 8:return c=e.sent,e.next=11,c.json();case 11:l=e.sent,this.setState({result:l.result,error:null}),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),this.setState({result:null,error:e.t0.toString()});case 18:case"end":return e.stop()}},e,this,[[0,15]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.match,r=this.state,o=r.result,c=r.error,l=a.params.hostname;return n.a.createElement(G.a,{classes:{paper:t.paper},fullWidth:!0,maxWidth:"md",onClose:this.handleClose,open:!0,scroll:"body"},n.a.createElement(X.a,{className:t.closeButton,onClick:this.handleClose},n.a.createElement(Q.a,null)),n.a.createElement(B.a,{className:t.title},"Errors"),null!==c?n.a.createElement(B.a,{color:"error"},c):null===o?n.a.createElement(B.a,{color:"textSecondary"},"Loading..."):Object.entries(o).map(function(e){var a=Object(g.a)(e,2),r=a[0],o=a[1];return n.a.createElement(n.a.Fragment,{key:r},n.a.createElement(B.a,{className:t.header},l," (PID: ",r,")"),o.length>0?o.map(function(e,a){var r=e.message,o=e.timestamp;return n.a.createElement("div",{className:t.error,key:a},n.a.createElement(B.a,{className:t.timestamp},"Error at ",new Date(1e3*o).toLocaleString()),n.a.createElement(Z,{lines:r.trim().split("\n")}))}):n.a.createElement(B.a,{color:"textSecondary"},"No errors found."))}))}}]),t}(n.a.Component),ee=x()(function(e){return O()({paper:{padding:e.spacing(3)},closeButton:{position:"absolute",right:e.spacing(1.5),top:e.spacing(1.5),zIndex:1},title:{borderBottomColor:e.palette.divider,borderBottomStyle:"solid",borderBottomWidth:1,fontSize:"1.5rem",lineHeight:1,marginBottom:e.spacing(3),paddingBottom:e.spacing(3)},header:{lineHeight:1,marginBottom:e.spacing(3),marginTop:e.spacing(3)},error:{backgroundColor:Object(q.fade)(e.palette.error.main,.06),borderLeftColor:e.palette.error.main,borderLeftStyle:"solid",borderLeftWidth:3,marginTop:e.spacing(3),padding:e.spacing(2)},timestamp:{color:e.palette.text.secondary,marginBottom:e.spacing(1)}})})($),te=function(e){function t(){var e,a;Object(l.a)(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).state={result:null,error:null},a.handleClose=function(){a.props.history.push("/")},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=Object(y.a)(E.a.mark(function e(){var t,a,r,n,o,c,l;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.props.match,a=t.params,r=a.hostname,n=a.pid,(o=new URL("/api/logs",window.location.origin)).searchParams.set("hostname",r),o.searchParams.set("pid",n||""),e.next=8,fetch(o.toString());case 8:return c=e.sent,e.next=11,c.json();case 11:l=e.sent,this.setState({result:l.result,error:null}),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),this.setState({result:null,error:e.t0.toString()});case 18:case"end":return e.stop()}},e,this,[[0,15]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.match,r=this.state,o=r.result,c=r.error,l=a.params.hostname;return n.a.createElement(G.a,{classes:{paper:t.paper},fullWidth:!0,maxWidth:"md",onClose:this.handleClose,open:!0,scroll:"body"},n.a.createElement(X.a,{className:t.closeButton,onClick:this.handleClose},n.a.createElement(Q.a,null)),n.a.createElement(B.a,{className:t.title},"Logs"),null!==c?n.a.createElement(B.a,{color:"error"},c):null===o?n.a.createElement(B.a,{color:"textSecondary"},"Loading..."):Object.entries(o).map(function(e){var a=Object(g.a)(e,2),r=a[0],o=a[1];return n.a.createElement(n.a.Fragment,{key:r},n.a.createElement(B.a,{className:t.header},l," (PID: ",r,")"),o.length>0?n.a.createElement(Z,{lines:o}):n.a.createElement(B.a,{color:"textSecondary"},"No logs found."))}))}}]),t}(n.a.Component),ae=x()(function(e){return O()({paper:{padding:e.spacing(3)},closeButton:{position:"absolute",right:e.spacing(1.5),top:e.spacing(1.5),zIndex:1},title:{borderBottomColor:e.palette.divider,borderBottomStyle:"solid",borderBottomWidth:1,fontSize:"1.5rem",lineHeight:1,marginBottom:e.spacing(3),paddingBottom:e.spacing(3)},header:{lineHeight:1,marginBottom:e.spacing(3),marginTop:e.spacing(3)}})})(te),re=function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return n.a.createElement(d.a,null,n.a.createElement(u.a,null),n.a.createElement(J,null),n.a.createElement(h.a,{component:ae,path:"/logs/:hostname/:pid?"}),n.a.createElement(h.a,{component:ee,path:"/errors/:hostname/:pid?"}))}}]),t}(n.a.Component);c.a.render(n.a.createElement(re,null),document.getElementById("root"))},81:function(e,t,a){e.exports=a(110)}},[[81,1,2]]]);
//# sourceMappingURL=main.7d6c7e29.chunk.js.map