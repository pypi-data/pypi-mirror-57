
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Prepare Cognito &#8212; Flask-AWSCognito 1.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Configure Flask app" href="configure_flask.html" />
    <link rel="prev" title="Installation" href="installation.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="prepare-cognito">
<h1>Prepare Cognito<a class="headerlink" href="#prepare-cognito" title="Permalink to this headline">¶</a></h1>
<div class="section" id="cloudformation">
<h2>CloudFormation<a class="headerlink" href="#cloudformation" title="Permalink to this headline">¶</a></h2>
<p>The following  CloudFormation template will create</p>
<ul class="simple">
<li><p>User Pool, a directory of users</p></li>
<li><p>User Pool Client - an entity that holds the configuration of authentication flow</p></li>
</ul>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">AWSTemplateFormatVersion</span><span class="p">:</span> <span class="s">&quot;2010-09-09&quot;</span>
<span class="nt">Description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Cognito Stack</span>

<span class="nt">Parameters</span><span class="p">:</span>
  <span class="nt">Domain</span><span class="p">:</span>
    <span class="nt">Type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">String</span>
    <span class="nt">Description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Unique Name for Cognito Resources</span>
  <span class="nt">SignInCallback</span><span class="p">:</span>
    <span class="nt">Type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">String</span>
    <span class="nt">Description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Full URL to be called after used is signed in</span>

<span class="nt">Resources</span><span class="p">:</span>
  <span class="nt">UserPool</span><span class="p">:</span>
    <span class="nt">Type</span><span class="p">:</span> <span class="s">&quot;AWS::Cognito::UserPool&quot;</span>
    <span class="nt">Properties</span><span class="p">:</span>
      <span class="nt">UserPoolName</span><span class="p">:</span> <span class="kt">!Join</span> <span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span> <span class="p p-Indicator">[</span><span class="kt">!Ref</span> <span class="nv">Domain</span><span class="p p-Indicator">,</span> <span class="s">&#39;user-pool&#39;</span><span class="p p-Indicator">]]</span>
      <span class="nt">AutoVerifiedAttributes</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">email</span>
      <span class="nt">Schema</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">Name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">email</span>
          <span class="nt">AttributeDataType</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">String</span>
          <span class="nt">Mutable</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
          <span class="nt">Required</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>

  <span class="nt">PoolClientUser</span><span class="p">:</span>
    <span class="nt">Type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AWS::Cognito::UserPoolClient</span>
    <span class="nt">Description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Pool client to be used by users</span>
    <span class="nt">Properties</span><span class="p">:</span>
      <span class="nt">ClientName</span><span class="p">:</span> <span class="kt">!Join</span> <span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span> <span class="p p-Indicator">[</span><span class="kt">!Ref</span> <span class="nv">Domain</span><span class="p p-Indicator">,</span> <span class="s">&#39;cognito-user-pool-client&#39;</span><span class="p p-Indicator">]]</span>
      <span class="nt">UserPoolId</span><span class="p">:</span> <span class="kt">!Ref</span> <span class="l l-Scalar l-Scalar-Plain">UserPool</span>
      <span class="nt">AllowedOAuthFlows</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">code</span>
      <span class="nt">CallbackURLs</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="kt">!Ref</span> <span class="l l-Scalar l-Scalar-Plain">SignInCallback</span>
      <span class="nt">AllowedOAuthFlowsUserPoolClient</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
      <span class="nt">AllowedOAuthScopes</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">email</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">openid</span>
      <span class="nt">SupportedIdentityProviders</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">COGNITO</span>
</pre></div>
</div>
</div>
<div class="section" id="domain">
<h2>Domain<a class="headerlink" href="#domain" title="Permalink to this headline">¶</a></h2>
<p>The template doesn’t create a Domain (not supported by CLoudFormation as of December 2019)
so it should be created manually from console or through API calls.</p>
<img alt="https://raw.githubusercontent.com/cgauge/Flask-AWSCognito/master/docs/img/cognito_domain.png" src="https://raw.githubusercontent.com/cgauge/Flask-AWSCognito/master/docs/img/cognito_domain.png" />
<p>Both options - “Amazon Cognito domain” and “Your own domain” are supported. Don’t forget to pass it
to Flask app config.</p>
</div>
<div class="section" id="redirect-url">
<h2>Redirect URL<a class="headerlink" href="#redirect-url" title="Permalink to this headline">¶</a></h2>
<p>One of the stack parameters of the CloudFormation template is a redirect URL. It’s a Flask endpoint users
will be redirected to after successful sign in (see <strong>Usage</strong>).</p>
</div>
<div class="section" id="id-to-pass-to-flask">
<h2>ID to pass to Flask<a class="headerlink" href="#id-to-pass-to-flask" title="Permalink to this headline">¶</a></h2>
<p>After resources are created we need User Pool ID, User Pool Client ID and User Pool Client Secret
(not shown on the screenshots) to configure Flask:</p>
<img alt="https://raw.githubusercontent.com/cgauge/Flask-AWSCognito/master/docs/img/poolid.png" src="https://raw.githubusercontent.com/cgauge/Flask-AWSCognito/master/docs/img/poolid.png" />
<img alt="https://raw.githubusercontent.com/cgauge/Flask-AWSCognito/master/docs/img/clientid.png" src="https://raw.githubusercontent.com/cgauge/Flask-AWSCognito/master/docs/img/clientid.png" />
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Flask-AWSCognito</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Prepare Cognito</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#cloudformation">CloudFormation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#domain">Domain</a></li>
<li class="toctree-l2"><a class="reference internal" href="#redirect-url">Redirect URL</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id-to-pass-to-flask">ID to pass to Flask</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="configure_flask.html">Configure Flask app</a></li>
<li class="toctree-l1"><a class="reference internal" href="auth_code.html">Authorization code grant</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="installation.html" title="previous chapter">Installation</a></li>
      <li>Next: <a href="configure_flask.html" title="next chapter">Configure Flask app</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, CustomerGauge.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/configure_aws.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>