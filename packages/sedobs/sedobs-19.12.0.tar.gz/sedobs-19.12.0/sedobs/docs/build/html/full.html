

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Full Simulation &mdash; SEDobs 0.1.9 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Outputs" href="output.html" />
    <link rel="prev" title="Multi-Spectroscopic Simulation" href="MultiSpectro.html" />
    <link href="_static/my_theme.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> SEDobs
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="atmospheric.html">Atmospheric effect</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="photo.html">Photometric Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Spectro.html">Spectroscopic Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="MultiSpectro.html">Multi-Spectroscopic Simulation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Full Simulation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#checking-configuration">Checking configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#preparation">Preparation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#simulation">Simulation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="output.html">Outputs</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SEDobs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Full Simulation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/full.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p id="spectroscopic-simulations"><img alt="Python36" src="https://img.shields.io/badge/python-3.6-blue.svg" /> <a class="reference external" href="http://perso.crans.org/besson/LICENSE.html"><img alt="Licence" src="https://img.shields.io/badge/License-GPLv3-blue.svg" /></a> <a class="reference external" href="http://www.numpy.org/"><img alt="numpy" src="https://img.shields.io/badge/poweredby-numpy-orange.svg" /></a> <a class="reference external" href="https://www.scipy.org/"><img alt="scipy" src="https://img.shields.io/badge/poweredby-scipy-orange.svg" /></a></p>
<div class="section" id="full-simulation">
<h1>Full Simulation<a class="headerlink" href="#full-simulation" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This exact run can be started in the test of SEDobs. if you hit the command <strong>sedobs – –test</strong> and select the multispectro simulation sedobs will run exactly this configuration.</p>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>We describe here the process the SEDobs uses when doing a photo-spectroscopic simulation with Ns=2 spectra per galaxy and Np=10 photometric bands. This will work of course with higher N.
The configuration we use is the one given below (named: SEDobs_Test_run_full.conf):</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>General<span class="o">]</span>
<span class="nv">Project_name</span><span class="o">=</span> SEDobs_Test_run_full
<span class="nv">Author</span><span class="o">=</span> R. THOMAS - <span class="m">14</span>/10/18
<span class="nv">Project_Directory</span><span class="o">=</span> ~/.sedobs/test_run_full
<span class="nv">full_array</span> <span class="o">=</span>
<span class="nv">z_distribution</span> <span class="o">=</span> dist_zspec_multi.txt
<span class="nv">Nobj</span> <span class="o">=</span> <span class="m">1500</span>
<span class="o">[</span>Data_Type<span class="o">]</span>
<span class="nv">Photometry</span> <span class="o">=</span> Yes
<span class="nv">Spectro</span> <span class="o">=</span> Yes
<span class="o">[</span>Spectro<span class="o">]</span>
<span class="nv">NSpec</span> <span class="o">=</span> <span class="m">2</span>
<span class="nv">Norm_band</span> <span class="o">=</span> <span class="o">(</span>r-megacam, <span class="m">0</span>.0, <span class="m">0</span>.1, <span class="m">0</span>.03<span class="o">)</span>
<span class="nv">Noise_reg</span> <span class="o">=</span>  <span class="o">(</span><span class="m">1080</span>,1170<span class="o">)</span><span class="p">;</span><span class="o">(</span><span class="m">3600</span>,3700<span class="o">)</span>
<span class="nv">Norm_distribution</span> <span class="o">=</span> dist_mag.txt
<span class="nv">types</span> <span class="o">=</span> <span class="o">(</span><span class="m">3500</span>,9500,7.25,240,dist_SNR1.txt<span class="o">)</span><span class="p">;</span><span class="o">(</span><span class="m">12000</span>,15000,50,100,dist_SNR2.txt<span class="o">)</span>
<span class="o">[</span>Photo<span class="o">]</span>
<span class="nv">Norm_band</span> <span class="o">=</span> r-megacam
<span class="nv">Norm_distribution</span> <span class="o">=</span> dist_mag.txt
<span class="nv">Nband</span> <span class="o">=</span> <span class="m">10</span>
<span class="nv">Band_list</span> <span class="o">=</span> <span class="o">(</span>u-megacam,0.0, <span class="m">0</span>.31, <span class="m">0</span>.38<span class="o">)</span><span class="p">;</span><span class="o">(</span>g-megacam,0.0,0.15,0.20<span class="o">)</span><span class="p">;</span><span class="o">(</span>r-megacam,0.0,0.19,0.09<span class="o">)</span><span class="p">;</span><span class="o">(</span>i-megacam, <span class="m">0</span>.0, <span class="m">0</span>.23, <span class="m">0</span>.12<span class="o">)</span><span class="p">;</span><span class="o">(</span>z-megacam,0.0, <span class="m">0</span>.38, <span class="m">0</span>.19<span class="o">)</span><span class="p">;</span><span class="o">(</span>J-wircam, <span class="m">0</span>.0, <span class="m">0</span>.68, <span class="m">0</span>.45<span class="o">)</span><span class="p">;</span><span class="o">(</span>H-wircam, <span class="m">0</span>.0, <span class="m">0</span>.71,0.37<span class="o">)</span><span class="p">;</span><span class="o">(</span>K-wircam,0.0,0.55, <span class="m">0</span>.41<span class="o">)</span><span class="p">;</span><span class="o">(</span>IRAC1,0.0,0.08, <span class="m">0</span>.04<span class="o">)</span><span class="p">;</span><span class="o">(</span>IRAC2,0.0,0.09,0.06<span class="o">)</span>
<span class="o">[</span>Cosmo<span class="o">]</span>
<span class="nv">Ho</span><span class="o">=</span><span class="m">70</span>
<span class="nv">Omega_m</span><span class="o">=</span><span class="m">0</span>.27
<span class="nv">Omega_L</span><span class="o">=</span><span class="m">0</span>.73
<span class="nv">Use_Cosmo</span><span class="o">=</span>Yes
<span class="o">[</span>Templates<span class="o">]</span>
<span class="nv">BaseSSP</span><span class="o">=</span>LIB_BC03_Delayed_LR_Salp_SPARTAN.hdf5
<span class="nv">DustUse</span><span class="o">=</span>calzetti.dat
<span class="nv">EBVList</span><span class="o">=</span><span class="m">0</span>.0<span class="p">;</span><span class="m">0</span>.1<span class="p">;</span><span class="m">0</span>.2<span class="p">;</span><span class="m">0</span>.30<span class="p">;</span><span class="m">0</span>.4<span class="p">;</span><span class="m">0</span>.50
<span class="nv">IGMUse</span> <span class="o">=</span> SPARTAN_Meiksin_Free_7curves.hdf5
<span class="c1">###IGM type free or mean or empty</span>
<span class="nv">IGMtype</span> <span class="o">=</span> free
<span class="nv">EMline</span><span class="o">=</span> yes
<span class="nv">Lyafrac</span> <span class="o">=</span> <span class="m">0</span>.5
<span class="nv">Age</span> <span class="o">=</span> <span class="m">0</span>.1e+09<span class="p">;</span><span class="m">0</span>.2e+09<span class="p">;</span><span class="m">0</span>.3e+09<span class="p">;</span><span class="m">0</span>.4e+09<span class="p">;</span><span class="m">0</span>.5e+09<span class="p">;</span><span class="m">0</span>.6e+09<span class="p">;</span><span class="m">0</span>.7e+09<span class="p">;</span><span class="m">0</span>.8e+09<span class="p">;</span><span class="m">0</span>.9e+09<span class="p">;</span><span class="m">1</span>.0e+09<span class="p">;</span><span class="m">1</span>.0e+09<span class="p">;</span><span class="m">1</span>.1e+09<span class="p">;</span><span class="m">1</span>.2e+09<span class="p">;</span><span class="m">1</span>.3e+09<span class="p">;</span><span class="m">1</span>.4e+09<span class="p">;</span><span class="m">1</span>.5e+09
<span class="nv">TAU</span> <span class="o">=</span> <span class="m">0</span>.10<span class="p">;</span><span class="m">0</span>.2<span class="p">;</span><span class="m">0</span>.3<span class="p">;</span><span class="m">0</span>.4<span class="p">;</span><span class="m">0</span>.5<span class="p">;</span><span class="m">0</span>.6<span class="p">;</span><span class="m">0</span>.7<span class="p">;</span><span class="m">0</span>.8<span class="p">;</span><span class="m">0</span>.9<span class="p">;</span><span class="m">1</span>.0
<span class="nv">MET</span> <span class="o">=</span> <span class="m">0</span>.4<span class="p">;</span><span class="m">1</span>.0<span class="p">;</span><span class="m">2</span>.5
</pre></div>
</div>
<p>We choose to use individual files (and not the full_array option).</p>
</div>
<div class="section" id="checking-configuration">
<h2>Checking configuration<a class="headerlink" href="#checking-configuration" title="Permalink to this headline">¶</a></h2>
<p>We start sedobs with this file (<em>sedobs –SEDobs_Test_run_full</em>) sedobs start by checking your configuration. You can see the output of the terminal for the full checking of your configuration:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/fullcheck.png"><img alt="GUI" src="_images/fullcheck.png" style="width: 750px;" /></a>
</div>
<ul class="simple">
<li><p><strong>1-General section checking</strong>:  First it tells you what file you loaded. Then it checks the general section of the configuration file. It makes sure that your directory exist and that the filter file is found. Since we do not give a full array, it assumes we give individual distribution (in the spectroscopic case the redshift distribution, normalisation magnitude distribution and SNR distribution). It checks that the redshift distribution is found and that the number of objects is given. In the project directory you will have this files (of course this has to be adapted to your project):</p></li>
</ul>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>Project Directory
    <span class="p">|</span>_SEDOBS.conf
    <span class="p">|</span>_dist_zspec_multi.txt
    <span class="p">|</span>_dist_mag.txt
    <span class="p">|</span>_dist_SNR1.txt
    <span class="p">|</span>_dits_SNR2.txt
</pre></div>
</div>
<ul class="simple">
<li><p><strong>2-Check data type</strong>: Then SEDobs check what type of data you want to simulate, in this case single spectroscopy</p></li>
<li><p><strong>3-Check Cosmology module</strong>: The cosmology configuration is verified</p></li>
<li><p><strong>4-Check the spectroscopic-photometric configuration</strong>: SEDobs then start to check the spectroscopic configuration. It checks the number of spectra that will be simulated per galaxy, also the normalisation band (and magnitude distribution).  It will check that a SNR distribution is given per simulated spectrum (2 simulated spectra –&gt; 2 distributions of SNR). Finally it will check that the types of spectra are given as well as the noise regions and it will look at all the bands that will be simulated.</p></li>
<li><p><strong>5-Check template configuration</strong>: Then SEDobs look at your template setting. It checks that all the input files are found (IGM, dust extinction, templates).</p></li>
</ul>
</div>
<div class="section" id="preparation">
<h2>Preparation<a class="headerlink" href="#preparation" title="Permalink to this headline">¶</a></h2>
<dl class="simple">
<dt>After this checks, SEDobs is going to prepare the extra files:</dt><dd><ul class="simple">
<li><p>The final redshift, normalisation magnitude and SNR distributions. From the four files given (see above), four new distributions will be created, matching the shape of the original ones with the number of object you want to create. Examples are given below for this run:</p></li>
</ul>
</dd>
</dl>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/fulldist.png"><img alt="GUI" src="_images/fulldist.png" style="width: 750px;" /></a>
</div>
<p>These four distributions will be joined in one file called ‘final_array_z_StN_mag.txt’ and placed in your project directory. This file can be re-used for another run using the <em>final array option</em>.</p>
<blockquote>
<div><ul class="simple">
<li><p>From the Ages, Tau and metallicities that you give in your configuration SEDobs recompute a library of templates and save it in <em>SEDobs_Test_run_multispectro.hdf5</em> (this name depends on the name of your project).</p></li>
<li><p>SEDobs starts to create the output files (with header). In this case it will be the parameter file, and the photometric (list of spectrum, redshift, normalisation magnitude) file. It also creates the spectra and original_template sub-directories</p></li>
</ul>
</div></blockquote>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>if you change some of the template parameters (Age, Tau, met) you must delete the <a href="#id1"><span class="problematic" id="id2">*</span></a>.hdf5 file that was created previously because SEDobs try to look for an already computed library of template before creating one.</p>
<p>It is the same for the <em>final_array_z_StN_mag.txt</em> file. If you change your redshift distribution of your normalisation band distribution you have to delete this file. SEDobs try to look for it to check if one is already here. If it finds it it will not recalculate it.</p>
</div>
</div>
<div class="section" id="simulation">
<h2>Simulation<a class="headerlink" href="#simulation" title="Permalink to this headline">¶</a></h2>
<p>After all these checking and preparations SEDobs starts to simulate. It will go throught the final_array_z_StN_mag.txt, one object at a time. For each object, SEDobs passes by different steps that are displayed in the terminal, an example is given below:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/fullobjectsingle.png"><img alt="GUI" src="_images/fullobjectsingle.png" style="width: 950px;" /></a>
</div>
<p>SEDobs start to take the library of templates that was created and adds emission lines. If you asked to give a certain fraction of lyman alpha emitters it will take it into account. Then the dust extinction will be added and the IGM as well. SEDobs will also tell you how many templates there is after all extinction are applied. Next, it will apply the cosmology to the library. The templaes will be redshifted and if you decided to use the cosmology it will keep only the templates that are younger than the age of the universe at the redshift of the simulated galaxy.</p>
<p>The template used for the simulated galaxy will then be chosen randomly in the left over templates. It will be normalize to the normalisation magnitude value in the normalisation band you choosed and apply sky emission (if used) to the template. After that, all the band in your configuration are computed. In each band, the error is computed from the mean and sigma of the gaussian given for each band. Then it will cut the right regions depending on all your spectral configuration and create the noise based on the noise regions that are given in the configuration and the sky emission (if used). This noise will be created so the SNR matches (see <a class="reference internal" href="configuration.html"><span class="doc">Configuration</span></a> page).</p>
<p>Finally, everything is saved (see <a class="reference internal" href="output.html"><span class="doc">Outputs</span></a>) for all the files that are created.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This exact run can be started in the test of SEDobs. if you hit the command <strong>sedobs –test</strong> and select the photometric simulation sedobs will run exactly this configuration.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="output.html" class="btn btn-neutral float-right" title="Outputs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="MultiSpectro.html" class="btn btn-neutral float-left" title="Multi-Spectroscopic Simulation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Romain Thomas

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>